# 构建本地镜像，将练习 2.2 编写的 httpserver 容器化

1. 编译main.go
   
   ```sh
   go build -o httpserver main.go
   ```

2. 进入 geekbang02 目录，打包 docker 镜像
   
   ```
   docker build -t rarexixi/httpserver:v0.1 .
   ```

# 将镜像推送至 docker 官方镜像仓库

```sh
docker push rarexixi/httpserver:v0.1  
```

# 通过 docker 命令启动本地 httpserver

 ```sh
 # 后台执行，映射 httpserver 端口 8080 到 主机端口 9870
 docker run -d -p 8080:9870 rarexixi/httpserver:v0.1
 ```

 如果遇到 `standard_init_linux.go:228: exec user process caused: exec format error`，需要关闭CGO 模式，执行 `go env -w CGO_ENABLED=0`，然后重新执行 go build 后续命令

# 通过 nsenter 进入容器查看 IP 配置

```sh
PID=$(docker inspect -f {{.State.Pid}} 0ff91868b57d)
nsenter --target $PID --mount --uts --ipc --net --pid
```

